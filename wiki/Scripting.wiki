<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>

  
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Scripting</title></head><body>
<h1>Scripting</h1>

<h2>Python</h2>

Scripting requires the installation of some version of Python. I am using Python version 2.7.18. Although my operating system, Ubuntu 
now includes newer version 3.xx versions of Python, I have continued to use Python version 2.7 which can be installed
along with other Python versions. 
<h3>Python 2.7 installation</h3>
Stock versions of Python2.7 may not have been compiled with Unicode support needed by <b>PythonQt</b>. Therefore,
it is suggested that the utility <b>pyenv</b> (<code>sudo apt install pyenv</code>) be installed and then use it to install the particular version of Python
that you wish.  Python can then be installed using the command:
<br>
 <code>$PYTHON_CONFIGURE_OPTS="--enable-unicode=ucs2" pyenv install 2.7.18</code><br>

<h2>PythonQt</h2>

Scripting support also requires installation of <b>PythonQt</b>. I am using
version 3.2 (PythonQt-master) which has wrappers for Qt version 5.11. <a href="https://sourceforge.net/projects/pythonqt/files/">https://sourceforge.net/projects/pythonqt/files/</a>.
Here is a brief overview of using PythonQt: <a href="https://doc.qt.io/archives/qq/qq23-pythonqt.html">https://doc.qt.io/archives/qq/qq23-pythonqt.html</a><br>

<br>

<h2>Wrappers</h2>

C++ classes that will be available to be used by PythonQt in scripts must have
Python wrapper functions generated using the PythonQt <span style="font-style: italic;">pythonqt_generator</span> application. Two
files must be supplied to <span style="font-style: italic;">pythonqt_generator</span>:
<br>
The currently defined wrappers can be generated by running this script in the "LayoutEditor" directory:
<br><code>$ ./generate_mypackage.sh
</code><br

<ol>

  <li>A wrapper header file including #include statements for all the
headers needed by classes which will be wrapped. This file is in the
<i>LayoutEditor</i> folder and is called '<span style="font-style: italic;">wrappers.h</span>'.</li>
  <li>An Xml file listing all the classes to be wrapped: This file is
also in the LayoutEditor folder and is called '<span style="font-style: italic;">typesystem_jmri.xml</span>'</li>
</ol>

In addtion, in the LayoutEditor folder can be found the Unix script
file '<span style="font-style: italic;">generate_mypackage.sh'</span>.
Of course, if you are using Windows, a suitable BAT file must be
created instead. <br>

<br>

The <span style="font-style: italic;">pythonqt_generator</span> app
when run will create all the wrappers in the LayoutEditor/jmri folder.
The wrapper functions are then compiled with LayoutEditor. This script
also specifies the QT version (the latest QT wrappers in <b>PythonQt</b> are
for QT version 5.11 so use that QT version) and which version of
PythonQt which will be used to generate the wrapper functions.&nbsp; The <span style="font-style: italic;">pythonqt_generator </span>app must be run whenever one of the following is true:<br>
<ol>
  <li>New functions or classes are added to those that <b>PythonQt</b> can use.</li>
  <li>New methods are added or modified to existing classes. Note that
all classes' methods that are to be be useable by <b>PythonQt</b> scripts must be
declared as 'public:'! <br>
  </li>
</ol>

<br>


</body></html>